[{"path":"https://hdrab127.github.io/modskurt/articles/getting-started.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Getting started","text":"vignette presents minimal workflow modelling distribution species abundance along environmental gradient. See … Define y, x, mu, …. rest vignette proceeds follows …","code":""},{"path":"https://hdrab127.github.io/modskurt/articles/getting-started.html","id":"load-packages-and-stan-files","dir":"Articles","previous_headings":"","what":"Load packages and stan files","title":"Getting started","text":"","code":"library(modskurt) library(ggplot2) # only needs to be run every time package installed or updated compile_stanmodels() ## [1] \"Already compiled: discrete.stan\" # for reproducibility set.seed(123456)"},{"path":"https://hdrab127.github.io/modskurt/articles/getting-started.html","id":"case-study---tuangi-vs--mud","dir":"Articles","previous_headings":"","what":"Case study - Tuangi vs. mud","title":"Getting started","text":"NZ cockle vs sediment mud content.","code":"data(tuangi) tuangi ## # A tibble: 764 × 11 ##    year    lon   lat count mud_pct tn_conc toc_pct tp_conc sst_min sst_avg ##    <chr> <dbl> <dbl> <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> ##  1 2017   175. -40.5     0    19.8     250    0.32     380    12.8    15.3 ##  2 2018   175. -40.5     1    26.7     500    0.3      380    12.9    15.6 ##  3 2017   175. -40.5     0    20       250    0.29     370    12.8    15.3 ##  4 2018   175. -40.5     0    23.3     250    0.24     360    12.9    15.6 ##  5 2017   175. -40.5     1    17.2     250    0.28     350    12.8    15.3 ##  6 2018   175. -40.5     0    19.9     250    0.21     330    12.9    15.6 ##  7 2017   175. -40.5     0    26.9     250    0.28     380    12.8    15.3 ##  8 2018   175. -40.5     0    44.1     500    0.39     420    12.9    15.6 ##  9 2017   175. -40.5     0    22.5     250    0.26     380    12.8    15.3 ## 10 2018   175. -40.5     0    34.8     250    0.34     390    12.9    15.6 ## # ℹ 754 more rows ## # ℹ 1 more variable: sst_max <dbl>"},{"path":"https://hdrab127.github.io/modskurt/articles/getting-started.html","id":"a--specify-initial-model","dir":"Articles","previous_headings":"","what":"A. Specify initial model","title":"Getting started","text":"","code":"spec <-   mskt_spec(data = tuangi,             # response and gradients (optional names for tidier outputs)             y = c('Tuangi (count)' = 'count'),             x = c('Mud (%)' = 'mud_pct'),             # distribution of abundance             dist = 'nb',             # shape of dist mean function, see ?mskt_shape()             shape = 'rdp',             # make predictions for every 1% of mud content             pred_grid = 0:100) str(spec) ## List of 20 ##  $ sample_prior: int 0 ##  $ hp_H        : num [1:2] 1.5 5 ##  $ hp_m        : num [1:2] 1 1 ##  $ hp_s        : num [1:2] -2 0.6 ##  $ hp_r        : num [1:2] 1.2 1.2 ##  $ hp_d        : num [1:2] 0.5 1 ##  $ hp_p        : num [1:2] 1.2 1.2 ##  $ use_r       : int 1 ##  $ fix_r       : num 0.5 ##  $ use_d       : int 1 ##  $ fix_d       : num 0 ##  $ use_p       : int 1 ##  $ fix_p       : num 1 ##  $ use_zi      : int 0 ##  $ hp_kap      : num 0.5 ##  $ hp_g0       : num [1:2] 3 1.5 ##  $ hp_g1       : num 3 ##  $ Nrep        : int 101 ##  $ xrep        : int [1:101] 0 1 2 3 4 5 6 7 8 9 ... ##  $ data        :function (prop = 1, seed = NULL)   ##   ..- attr(*, \"srcref\")= 'srcref' int [1:8] 97 16 130 3 16 3 1114 1147 ##   .. ..- attr(*, \"srcfile\")=Classes 'srcfilealias', 'srcfile' <environment: 0x000001c78808cd18>  ##  - attr(*, \"pars\")= chr [1:7] \"H\" \"m\" \"s\" \"r\" ... ##  - attr(*, \"nms\")=List of 2 ##   ..$ y: chr \"Tuangi (count)\" ##   ..$ x: chr \"Mud (%)\" ##  - attr(*, \"dist\")= chr \"nb\" ##  - attr(*, \"shape\")= chr \"rdp\" ##  - attr(*, \"class\")= chr [1:2] \"mskt-spec\" \"list\""},{"path":"https://hdrab127.github.io/modskurt/articles/getting-started.html","id":"b--verify-initial-model-specification","dir":"Articles","previous_headings":"","what":"B. Verify initial model specification","title":"Getting started","text":"four key checks models using following functions check_prior_dens check_prior_mskt check_prior_dist check_prior_zero","code":"check_prior_dens(spec) # check_prior_mskt(spec) # preds (cover all possible) # check_prior_dist(spec) # ymax (severe tests) # check_prior_zero(spec) # zi link # OPTIONAL: refine model spec"},{"path":"https://hdrab127.github.io/modskurt/articles/getting-started.html","id":"c--fit-subset-model","dir":"Articles","previous_headings":"","what":"C. Fit subset model","title":"Getting started","text":"","code":"fit_train <-   mskt_fit(spec,            # set the training sample            train_prop = 0.3,            iter_warmup = 200,            iter_sampling = 100,            chains = 6,            parallel_chains = 6,            # for testing            show_messages = TRUE, show_exceptions = TRUE) # OPTIONAL: refine model spec or fit parameters check_computation(fit_train) ## spec: nb[Hmsrdp] using 229 obs out of 762 (30% sample) ## post: 6 chains each with 100 draws (600 total) ## $summary ## # A tibble: 7 × 10 ##   variable   mean median     sd    mad     q5    q95   rhat  ess_bulk  ess_tail ##   <chr>     <num>  <num>  <num>  <num>  <num>  <num> <rhat>     <ess>     <ess> ## 1 H        22.2   21.2   7.21   8.35   12.7   34.9     1.02 276 (0.5) 285 (0.5) ## 2 m        13.7   13.4   5.41   4.36    5.87  22.9     1.04 231 (0.4) 134 (0.2) ## 3 s        23.0   22.1   5.26   4.29   16.2   32.9     1.01 242 (0.4) 297 (0.5) ## 4 r         0.727  0.757 0.143  0.124   0.430  0.903   1.02 203 (0.3) 259 (0.4) ## 5 d         0.600  0.561 0.300  0.303   0.181  1.19    1.00 380 (0.6) 295 (0.5) ## 6 p         0.731  0.733 0.328  0.373   0.196  1.27    1.02 273 (0.5) 400 (0.7) ## 7 kap       1.13   1.13  0.0656 0.0636  1.03   1.24    1.01 339 (0.6) 398 (0.7) ##  ## $diagnostics ##   chain_id warmup sampling total num_divergent num_max_treedepth     ebfmi ## 1        1  1.591    0.802 2.393             0                 0 1.0103225 ## 2        2  1.694    0.951 2.645             0                 0 0.9241363 ## 3        3  1.579    0.900 2.479             0                 0 0.8571377 ## 4        4  1.509    0.731 2.240             0                 0 1.1684455 ## 5        5  1.521    0.737 2.258             1                 0 1.0338997 ## 6        6  1.587    0.988 2.575             0                 0 0.9378795 # OPTIONAL: refine model spec or fit parameters"},{"path":"https://hdrab127.github.io/modskurt/articles/getting-started.html","id":"check-subset-model","dir":"Articles","previous_headings":"C. Fit subset model","what":"Check subset model","title":"Getting started","text":"","code":"# check_post_dens(fit_train) # check_post_dist(fit_train) # check_post_zero(fit_train) # uses test set for discrete pit # check_post_calibration(fit_train) # OPTIONAL: refine model spec or fit parameters"},{"path":"https://hdrab127.github.io/modskurt/articles/getting-started.html","id":"d--fit-full-model","dir":"Articles","previous_headings":"","what":"D. Fit full model","title":"Getting started","text":"","code":"fit_full <-   mskt_fit(spec,            chains = 4,            parallel_chains = 4,            # for testing            show_messages = TRUE, show_exceptions = TRUE) check_computation(fit_full) ## spec: nb[Hmsrdp] using 762 obs out of 762 (100% sample) ## post: 4 chains each with 1000 draws (4000 total) ## $summary ## # A tibble: 7 × 10 ##   variable   mean median     sd    mad     q5    q95  rhat   ess_bulk   ess_tail ##   <chr>     <num>  <num>  <num>  <num>  <num>  <num> <rha>      <ess>      <ess> ## 1 H        22.0   21.1   6.78   7.27   12.8   34.4    1.00 1487 (0.4) 2029 (0.5) ## 2 m        13.4   13.2   2.91   2.79    8.93  18.3    1.00 1880 (0.5) 1401 (0.4) ## 3 s        22.7   22.1   3.96   3.43   17.5   30.0    1.01 1305 (0.3) 1752 (0.4) ## 4 r         0.765  0.779 0.0885 0.0796  0.596  0.881  1.00 1609 (0.4) 1925 (0.5) ## 5 d         0.534  0.508 0.246  0.244   0.178  0.986  1.00 1817 (0.5) 1537 (0.4) ## 6 p         0.753  0.766 0.302  0.325   0.240  1.23   1.00 1633 (0.4) 1674 (0.4) ## 7 kap       1.19   1.19  0.0377 0.0374  1.13   1.25   1.00 2881 (0.7) 2220 (0.6) ##  ## $diagnostics ##   chain_id warmup sampling  total num_divergent num_max_treedepth     ebfmi ## 1        1 21.907   27.818 49.725             0                 0 0.9800329 ## 2        2 21.279   28.728 50.007             0                 0 0.8176009 ## 3        3 21.654   31.067 52.721             0                 0 0.9935090 ## 4        4 21.449   29.213 50.662             0                 0 0.8122649 # OPTIONAL: refine model spec or fit parameters"},{"path":"https://hdrab127.github.io/modskurt/articles/getting-started.html","id":"check-full-model","dir":"Articles","previous_headings":"D. Fit full model","what":"Check full model","title":"Getting started","text":"","code":"# check_post_dens(fit_full) # check_post_dist(fit_full) # check_post_zero(fit_full) # uses loocv for discrete pit and pareto-k # check_post_calibration(fit_train) # check_post_influencers(fit_train) # OPTIONAL: refine model spec or fit parameters"},{"path":[]},{"path":"https://hdrab127.github.io/modskurt/articles/getting-started.html","id":"plot-summaries-of-the-abundance-distribution","dir":"Articles","previous_headings":"E. Use the model","what":"Plot summaries of the abundance distribution","title":"Getting started","text":"","code":"# plot the distribution of abundance along the gradient abundance_dist(fit_full,                summaries = c('mean', 'median', 'q90'),                # whether to use expectations and quantiles from nb or zinbl                include_zero_inflation = TRUE)"},{"path":"https://hdrab127.github.io/modskurt/articles/getting-started.html","id":"calculate-ranges-of-x-for-different-percentages-of-abundance-measures","dir":"Articles","previous_headings":"E. Use the model","what":"Calculate ranges of x for different percentages of abundance measures","title":"Getting started","text":"","code":"# assess different range measures of abundance along the gradient abundance_range(fit_full,                 # smallest range with ...                 capture_pct = 75,                 # mean abundance >= % of max abundance (highest mean)                 using_range = 'high_zone',                 # which distribution summary to use                 based_on = 'q90',                 # one-sided threshold or central range                 region = 'centre',                 # whether to use expectations and quantiles from nb or zinbl                 include_zero_inflation = FALSE) ##  ## Species range (see x.avg row) calculated as the region of x where the 0.9 prob. quantile of abundance (Q[90]) is within 75% of the highest value of Q[90] along x (averaged across posterior draws): ##               left     centre      right ## q90.avg 11.2200000 20.6600000  5.0505672 ## q90.se   0.3548958  0.2224355  0.0761786 ## x.avg    0.0000000 14.0831218 64.7894328 ## x.se     0.0000000  0.3161532  0.5070136"},{"path":"https://hdrab127.github.io/modskurt/articles/getting-started.html","id":"visually-display-abundance-ranges","dir":"Articles","previous_headings":"E. Use the model","what":"Visually display abundance ranges","title":"Getting started","text":"","code":"# or plot them as well # we'll compare high-zone and most-dens here using patchwork library(patchwork) (   abundance_range(fit_full,                   capture_pct = 75,                   using_range = 'high_zone',                   based_on = 'q90',                   region = 'centre',                   plotted = TRUE,                   range_colour = 'red') +     labs(subtitle = '75% Highest Abundance Zone (HAZ)') ) + (   abundance_range(fit_full,                   capture_pct = 75,                   using_range = 'most_dens',                   based_on = 'q90',                   region = 'centre',                   plotted = TRUE,                   range_colour = 'blue') +     labs(y = NULL, subtitle = '75% Abundance Density Limit (ADL)') ) +   plot_layout(guides = 'collect') ##  ## Species range (see x.avg row) calculated as the region of x where the 0.9 prob. quantile of abundance (Q[90]) is within 75% of the highest value of Q[90] along x (averaged across posterior draws): ##               left    centre       right ## q90.avg 11.7000000 20.160000  4.89212121 ## q90.se   0.3223004  0.188138  0.06698912 ## x.avg    0.0000000 14.560896 65.44787879 ## x.se     0.0000000  0.360336  0.41358159 ##  ## Species range (see x.avg row) calculated as the smallest region of x where the density of 0.9 prob. quantile of abundance (Q[90]) is equal to 75% of the total density of Q[90] along x (averaged across posterior draws): ##                left     centre      right ## q90.avg 19.26674426 18.3419449  7.1911905 ## q90.se   0.21566991  0.1904811  0.1089447 ## x.avg    7.21018728 26.8650867 57.4174603 ## x.se     0.06742754  0.1587907  0.2889340 # note how HAZ prefers higher relative abundance summaries as opposed to ADL # which considers total abundance summaries irrespective of the relative # abundance at each x (e.g. tuangi appear quite abundant in low mud %, but # their density along the whole gradient is skewed towards slightly higher mud # content) # OPTIONAL (but not advised): refine model spec or fit parameters"},{"path":"https://hdrab127.github.io/modskurt/articles/getting-started.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Getting started","text":"…","code":""},{"path":"https://hdrab127.github.io/modskurt/articles/prior-specification.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Prior Specification","text":"Encoding prior information model via prior probability distributions rarely simple mapping. need ensure prior distributions give credible probabilities observing parameters values, together, joint prior distribution predicts credible outcomes interest. practice, prior specification requires bit tinkering correctly encode information priors parameters interpretable values, predictions joint priors parameters less interpretable values. clear, don’t want priors overfit specific realisation data available, instead prior generalise plausible data generated species-environment relationship wish model. Two interactive pages created help encode information priors modskurt models, “severe” tests check misspecification: modskurt mean function describes shape average abundance along gradient question: https://salt-ecology.shinyapps.io/modskurt-prior-specs/ negative binomial-based abundance distributions describe probability observing different species counts excess-zeros given modskurt mean: https://salt-ecology.shinyapps.io/nb-zinbl-prior-specs/","code":""},{"path":"https://hdrab127.github.io/modskurt/articles/prior-specification.html","id":"in-practice","dir":"Articles","previous_headings":"","what":"In practice","title":"Prior Specification","text":"Take tuangi example “Getting started” suppose ","code":""},{"path":"https://hdrab127.github.io/modskurt/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Hayden Rabel. Author, maintainer. Adam Smith. Author. Marti Anderson. Author. team PRIMER-e. Author.","code":""},{"path":"https://hdrab127.github.io/modskurt/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Rabel H, Smith , Anderson M, PRIMER-e t (2023). modskurt: Bayesian Distributions Species Abundance Along Environmental Gradients. R package version 0.1.0, https://hdrab127.github.io/modskurt/.","code":"@Manual{,   title = {modskurt: Bayesian Distributions of Species Abundance Along Environmental Gradients},   author = {Hayden Rabel and Adam Smith and Marti Anderson and the team {at PRIMER-e}},   year = {2023},   note = {R package version 0.1.0},   url = {https://hdrab127.github.io/modskurt/}, }"},{"path":"https://hdrab127.github.io/modskurt/index.html","id":"modskurt-","dir":"","previous_headings":"","what":"Bayesian Distributions of Species Abundance Along Environmental Gradients","title":"Bayesian Distributions of Species Abundance Along Environmental Gradients","text":"Bayesian modelling species abundance distributions along environmental gradients","code":""},{"path":"https://hdrab127.github.io/modskurt/index.html","id":"installing-modskurt","dir":"","previous_headings":"","what":"Installing modskurt","title":"Bayesian Distributions of Species Abundance Along Environmental Gradients","text":"modskurt package utilises Stan Bayesian modelling software implemented R cmdstanr package. First, install cmdstanr interface (already) running install cmdstan , try hiccups , see https://mc-stan.org/cmdstanr/articles/cmdstanr.html. Now install modskurt (currently beta version github ), try running finally, compile modskurt Stan models specifically computer, run","code":"install.packages('cmdstanr', repos = c('https://mc-stan.org/r-packages/', getOption('repos'))) library(cmdstanr) check_cmdstan_toolchain(fix = TRUE) install_cmdstan(cores = 2) # install.packages('pak') pak::pkg_install('hdrab/modskurt') library(modskurt) # only needs running after new package install or package update compile_stanmodels()"},{"path":"https://hdrab127.github.io/modskurt/index.html","id":"fitting-a-model","dir":"","previous_headings":"","what":"Fitting a model","title":"Bayesian Distributions of Species Abundance Along Environmental Gradients","text":"check installation worked, try fitting simple negative binomial regression assymetric modskurt mean","code":"# model specification with fake data spec <-   mskt_spec(data = mskt_sim_nb(x = 0:50,                                 H = 100,                                m = 35,                                s = 40,                                r = 0.9,                                kappa = 0.5),             y = c('Abundance (count)' = 'y'),             x = c('Env gradient' = 'x'),             dist = 'nb') # fit a minimal model (with less than optimal iterations) fit <- mskt_fit(spec,                 iter_warmup = 200,                 iter_sampling = 100)  # check the posterior summary and computation diagnostics check_computation(fit)  # plot the abundance distribution abundance_dist(fit)"},{"path":"https://hdrab127.github.io/modskurt/index.html","id":"how-to-use-the-modskurt-package","dir":"","previous_headings":"","what":"How to use the modskurt package","title":"Bayesian Distributions of Species Abundance Along Environmental Gradients","text":"Statistical modelling often requires just computing algorithms, see Getting started recommended workflow takes species-environment data Bayesian workflow incorporate ecological knowledge instil trust results.","code":""},{"path":"https://hdrab127.github.io/modskurt/index.html","id":"roadmap-and-contribution","dir":"","previous_headings":"","what":"Roadmap and contribution","title":"Bayesian Distributions of Species Abundance Along Environmental Gradients","text":"current development version modskurt package much infancy. Planned additions vague order priority :   vignettes examples   Model comparison (e.g. nb zinbl)   Continuous abundance (like biomass)   Binary package Cran drat   Random effects   Temporal effects   Multiple gradients (2d modskurts)   Multiple species   …","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/abundance_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Distribution of abundance along the environmental gradient — abundance_dist","title":"Distribution of abundance along the environmental gradient — abundance_dist","text":"Distribution abundance along environmental gradient","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/abundance_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distribution of abundance along the environmental gradient — abundance_dist","text":"","code":"abundance_dist(   fit,   seed = NULL,   ndraws = 50,   summaries = c(\"mean\", \"q90\"),   include_zero_inflation = TRUE,   point_alpha = 0.2,   line_alpha = 0.1 )"},{"path":"https://hdrab127.github.io/modskurt/reference/abundance_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distribution of abundance along the environmental gradient — abundance_dist","text":"fit modskurt_fit object seed optional seed ndraws sample ndraws optional subset posterior draws summaries character vector distribution summarise, see details include_zero_inflation whether include zero-inflation summaries point_alpha opacity data points, default 0.1 good ~ 1000 obs line_alpha opacity summary lines, default 0.1 good ~ 50 draws","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/abundance_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distribution of abundance along the environmental gradient — abundance_dist","text":"ggplot object","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/abundance_range.html","id":null,"dir":"Reference","previous_headings":"","what":"Assess abundance range along x using distributional measures — abundance_range","title":"Assess abundance range along x using distributional measures — abundance_range","text":"Assess abundance range along x using distributional measures","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/abundance_range.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assess abundance range along x using distributional measures — abundance_range","text":"","code":"abundance_range(   fit,   seed = NULL,   ndraws = 50,   capture_pct = 80,   using_range = \"high_zone\",   based_on = \"median\",   region = \"centre\",   include_zero_inflation = FALSE,   plotted = FALSE,   point_alpha = 0.2,   line_alpha = 0.02,   range_colour = \"red\" )"},{"path":"https://hdrab127.github.io/modskurt/reference/abundance_range.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assess abundance range along x using distributional measures — abundance_range","text":"fit modskurt_fit object seed optional seed ndraws sample ndraws optional subset posterior draws capture_pct percent total abundance density (most_dens) percent tolerance highest abundance summary (high_zone), based \"based_on\" summary abundance using_range \"most_dens\" range highest abundance density, \"high_zone\" range x abundance summary within highest possible, see details based_on distribution summary use density high zone, one \"mean\", \"median\", quantile proportion \"q\" + pecentage (e.g. \"q90\" = 90% quantile) region one-sided threshold (\"left\", \"right\") central range (\"centre\") include_zero_inflation whether use expectations quantiles nb zinbl plotted plot abundance distribution point_alpha opacity data points, default 0.1 good ~ 1000 obs line_alpha opacity summary lines, default 0.1 good ~ 50 draws range_colour colour range geometries","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/abundance_range.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assess abundance range along x using distributional measures — abundance_range","text":"matrix ranges, ggplot object plotted TRUE","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/check_computation.html","id":null,"dir":"Reference","previous_headings":"","what":"Check posterior computation is acceptable — check_computation","title":"Check posterior computation is acceptable — check_computation","text":"Check posterior computation acceptable","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/check_computation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check posterior computation is acceptable — check_computation","text":"","code":"check_computation(fit, show_info = TRUE)"},{"path":"https://hdrab127.github.io/modskurt/reference/check_computation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check posterior computation is acceptable — check_computation","text":"fit modskurt_fit object show_info print information model spec posterior sample","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/check_computation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check posterior computation is acceptable — check_computation","text":"list ...","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/check_prior_dens.html","id":null,"dir":"Reference","previous_headings":"","what":"Check marginal prior densities are encoded correctly — check_prior_dens","title":"Check marginal prior densities are encoded correctly — check_prior_dens","text":"Check marginal prior densities encoded correctly","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/check_prior_dens.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check marginal prior densities are encoded correctly — check_prior_dens","text":"","code":"check_prior_dens(   spec,   train_prop = 1,   train_seed = NULL,   prob_inner = 0.5,   prob_outer = 0.99 )"},{"path":"https://hdrab127.github.io/modskurt/reference/check_prior_dens.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check marginal prior densities are encoded correctly — check_prior_dens","text":"spec modskurt model specification returned `mskt_spec` train_prop proportion data train posterior train_seed seed training sample proportion `train_prop` prob_inner inner probability (high density interval) highlight prob_outer outer probability range plot density ","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/check_prior_dens.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check marginal prior densities are encoded correctly — check_prior_dens","text":"patchwork ggplots","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/compile_stanmodels.html","id":null,"dir":"Reference","previous_headings":"","what":"Compile modskurt Stan Models — compile_stanmodels","title":"Compile modskurt Stan Models — compile_stanmodels","text":"Compile modskurt Stan Models","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/compile_stanmodels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compile modskurt Stan Models — compile_stanmodels","text":"","code":"compile_stanmodels(force_recompile = FALSE)"},{"path":"https://hdrab127.github.io/modskurt/reference/compile_stanmodels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compile modskurt Stan Models — compile_stanmodels","text":"force_recompile whether recompile even nothing changed","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/dnbinom2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Negative Binomial Probability Mass Function (alternative parameterisation) — dnbinom2","title":"The Negative Binomial Probability Mass Function (alternative parameterisation) — dnbinom2","text":"Negative Binomial Probability Mass Function (alternative parameterisation)","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/dnbinom2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Negative Binomial Probability Mass Function (alternative parameterisation) — dnbinom2","text":"","code":"dnbinom2(x, mu, kappa, log = FALSE)"},{"path":"https://hdrab127.github.io/modskurt/reference/dnbinom2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Negative Binomial Probability Mass Function (alternative parameterisation) — dnbinom2","text":"x vector (non-negative integer) quantiles mu mean kappa dispersion (inverse square root size) log logical; TRUE, probabilities p given log(p)","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/dnbinom2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Negative Binomial Probability Mass Function (alternative parameterisation) — dnbinom2","text":"(log) probability mass x, given mu kappa","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/dzinb2.html","id":null,"dir":"Reference","previous_headings":"","what":"Zero-inflated Negative Binomial Probability Mass — dzinb2","title":"Zero-inflated Negative Binomial Probability Mass — dzinb2","text":"Zero-inflated Negative Binomial Probability Mass","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/dzinb2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Zero-inflated Negative Binomial Probability Mass — dzinb2","text":"","code":"dzinb2(x, mu, kappa, zi, log = FALSE)"},{"path":"https://hdrab127.github.io/modskurt/reference/dzinb2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Zero-inflated Negative Binomial Probability Mass — dzinb2","text":"x vector (non-negative integer) values mu mean distribution kappa dispersion (inverse square root size) zi vector (real lying \\[0, 1\\]) zero-inflation parameters log logical; TRUE, probabilities, p, given log(p)","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/dzinb2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Zero-inflated Negative Binomial Probability Mass — dzinb2","text":"(log) probability mass x, given mu, kappa zi","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/kappa_to_phi.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert overdispersion kappa to reciprocal dispersion phi — kappa_to_phi","title":"Convert overdispersion kappa to reciprocal dispersion phi — kappa_to_phi","text":"Convert overdispersion kappa reciprocal dispersion phi","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/kappa_to_phi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert overdispersion kappa to reciprocal dispersion phi — kappa_to_phi","text":"","code":"kappa_to_phi(kappa)"},{"path":"https://hdrab127.github.io/modskurt/reference/kappa_to_phi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert overdispersion kappa to reciprocal dispersion phi — kappa_to_phi","text":"kappa overdispersion parameter","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/mskt.html","id":null,"dir":"Reference","previous_headings":"","what":"Log-Modskurt (mskt) unimodal mean function — mskt","title":"Log-Modskurt (mskt) unimodal mean function — mskt","text":"Log-Modskurt (mskt) unimodal mean function","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/mskt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log-Modskurt (mskt) unimodal mean function — mskt","text":"","code":"mskt(x, H, m, s, r = 0.5, d = 0, p = 1)"},{"path":"https://hdrab127.github.io/modskurt/reference/mskt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log-Modskurt (mskt) unimodal mean function — mskt","text":"x predictor variable (real number vector) H height curve mode (real number > 0) m mode (real number) s scale (real number > 0) r asymmetry (real number (0, 1)) d flatness (real number >= 0) p tail exaggeration (real number (0, 2))","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/mskt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log-Modskurt (mskt) unimodal mean function — mskt","text":"vector log-scale mean values (real number vector)","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/mskt_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit the specified modskurt model by sampling its posterior distribution — mskt_fit","title":"Fit the specified modskurt model by sampling its posterior distribution — mskt_fit","text":"Fit specified modskurt model sampling posterior distribution","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/mskt_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit the specified modskurt model by sampling its posterior distribution — mskt_fit","text":"","code":"mskt_fit(   spec,   train_prop = 1,   train_seed = NULL,   seed = NULL,   init = NULL,   chains = 4,   parallel_chains = getOption(\"mc.cores\", 1),   iter_warmup = 1000,   iter_sampling = 1000,   max_treedepth = NULL,   adapt_delta = NULL,   show_messages = TRUE,   show_exceptions = FALSE,   ... )"},{"path":"https://hdrab127.github.io/modskurt/reference/mskt_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit the specified modskurt model by sampling its posterior distribution — mskt_fit","text":"spec modskurt model specification returned `mskt_spec` train_prop proportion data train posterior train_seed seed training sample proportion `train_prop` seed seed Stan random number generator init initialisation method, see ?cmdstanr::`model-method-sample` chains number Markov chains parallel_chains many cores distribute chains iter_warmup number iterations used learn posterior curvature iter_sampling number posterior samples drawn max_treedepth, adapt_delta tuning parameters, see details show_messages additional verbosity show_exceptions additional verbosity ... additional arguments ?cmdstanr::`model-method-sample`","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/mskt_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit the specified modskurt model by sampling its posterior distribution — mskt_fit","text":"`cmdstanr::CmdStanMCMC` object","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/mskt_inits.html","id":null,"dir":"Reference","previous_headings":"","what":"internal only for initialising from prior — mskt_inits","title":"internal only for initialising from prior — mskt_inits","text":"internal initialising prior","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/mskt_inits.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"internal only for initialising from prior — mskt_inits","text":"","code":"mskt_inits(sdat, chains, from_data = TRUE)"},{"path":"https://hdrab127.github.io/modskurt/reference/mskt_sim_nb.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate negative binomial data with a modskurt mean curve — mskt_sim_nb","title":"Simulate negative binomial data with a modskurt mean curve — mskt_sim_nb","text":"Simulate negative binomial data modskurt mean curve","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/mskt_sim_nb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate negative binomial data with a modskurt mean curve — mskt_sim_nb","text":"","code":"mskt_sim_nb(x, H, m, s, r = 0.5, d = 0, p = 1, kappa, g0 = 0, g1 = 0)"},{"path":"https://hdrab127.github.io/modskurt/reference/mskt_sim_nb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate negative binomial data with a modskurt mean curve — mskt_sim_nb","text":"x vector environmental gradient values H height m middle s spread r assymetry d flatness p persistence kappa negative binomial dispersion g0 constant rate zero-inflation g1 decay zero-inflation mean increases","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/mskt_sim_nb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate negative binomial data with a modskurt mean curve — mskt_sim_nb","text":"data.frame simulated mu, zi, y x","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/mskt_spec.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify modskurt model for the distribution of `y` over `x` — mskt_spec","title":"Specify modskurt model for the distribution of `y` over `x` — mskt_spec","text":"Specify modskurt model distribution `y` `x`","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/mskt_spec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify modskurt model for the distribution of `y` over `x` — mskt_spec","text":"","code":"mskt_spec(   data,   y,   x,   effort = NULL,   dist = \"nb\",   shape = \"rdp\",   hyperparams = list(),   pred_grid = NULL )"},{"path":"https://hdrab127.github.io/modskurt/reference/mskt_spec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify modskurt model for the distribution of `y` over `x` — mskt_spec","text":"data data.frame tibble y species count, optionally named - see details x environmental gradient, optionally named - see details effort sampling effort used observe y dist distribution y x shape shape distribution mean - see ?mskt_shape() hyperparams list hyper-parameters adjust -built priors pred_grid vector x values make y predictions ","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/mskt_spec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify modskurt model for the distribution of `y` over `x` — mskt_spec","text":"list standata prior verification posterior estimation","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/mskt_spec.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify modskurt model for the distribution of `y` over `x` — mskt_spec","text":"## Forms discrete (count) data distribution - `\"nb\"`: Negative Binomial - `\"zinbl\"`: Zero-inflated Negative Binomial (Linked) interactive graph count distributions possible parameters available [https://salt-ecology.shinyapps.io/nb-zinbl-prior-specs/](). ## Shapes mean function - default: height (H), mode (m), scale (s) - optional extras   + `\"r\"` assymmetry skew   + `\"d\"` flatness peakedness   + `\"p\"` tail exaggeration pinching can combined desired, e.g. `\"rp\"`, `\"rdp\"`, ... interactive graph modskurt mean function possible parameters available [https://salt-ecology.shinyapps.io/modskurt-prior-specs/]().","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/qnbinom2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Negative Binomial Quantile Function (alternative parameterisation) — qnbinom2","title":"The Negative Binomial Quantile Function (alternative parameterisation) — qnbinom2","text":"Negative Binomial Quantile Function (alternative parameterisation)","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/qnbinom2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Negative Binomial Quantile Function (alternative parameterisation) — qnbinom2","text":"","code":"qnbinom2(p, mu, kappa, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://hdrab127.github.io/modskurt/reference/qnbinom2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Negative Binomial Quantile Function (alternative parameterisation) — qnbinom2","text":"p vector probabilities mu mean kappa dispersion (inverse square root size) lower.tail logical; TRUE (default), probablities \\(P[X <= x]\\), otherwise, \\([X > x]\\) log.p logical; TRUE, probabilities given log(p)","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/qnbinom2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Negative Binomial Quantile Function (alternative parameterisation) — qnbinom2","text":"vector quantiles, correspond probability p","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/qzinb2.html","id":null,"dir":"Reference","previous_headings":"","what":"Zero-inflated Negative Binomial Quantile Function — qzinb2","title":"Zero-inflated Negative Binomial Quantile Function — qzinb2","text":"Zero-inflated Negative Binomial Quantile Function","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/qzinb2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Zero-inflated Negative Binomial Quantile Function — qzinb2","text":"","code":"qzinb2(p, mu, kappa, zi, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://hdrab127.github.io/modskurt/reference/qzinb2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Zero-inflated Negative Binomial Quantile Function — qzinb2","text":"p vector quantiles mu mean distribution kappa dispersion (inverse square root size) zi vector (\\([0, 1]\\)) zero-inflation parameters lower.tail logical; TRUE (default), probabilities \\(P[X <= x]\\), otherwise, \\(P[X > x]\\) log.p logical; TRUE, probabilities p. affect zi","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/qzinb2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Zero-inflated Negative Binomial Quantile Function — qzinb2","text":"vector quantiles, coincide respective probability p","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. rlang %||%","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/tuangi.html","id":null,"dir":"Reference","previous_headings":"","what":"Tuangi (NZ Cockle) estuarine abundance — tuangi","title":"Tuangi (NZ Cockle) estuarine abundance — tuangi","text":"Discrete counts tuangi intertidal estuaries New Zealand","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/tuangi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tuangi (NZ Cockle) estuarine abundance — tuangi","text":"","code":"data(tuangi)"},{"path":"https://hdrab127.github.io/modskurt/reference/tuangi.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Tuangi (NZ Cockle) estuarine abundance — tuangi","text":"## `tuangi` data frame 764 rows 11 columns: year Year survey lon, lat Longitude latitude sample count Total tuangi counted 250 gram sediment core mud_pct % sediment muddy (<63microns?) time sampling tn_conc total nitrogen concentration (mg/L) time sampling toc_pct total organic carbon content (%) time sampling tp_conc total phosphorus concentration (mg/L) time sampling sst_min, sst_avg, sst_max Min, mean, max sea surface temperature (deg C) location sampling 12 months preceding","code":""},{"path":"https://hdrab127.github.io/modskurt/reference/tuangi.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Tuangi (NZ Cockle) estuarine abundance — tuangi","text":"<https://www.saltecology.co.nz/>","code":""}]
